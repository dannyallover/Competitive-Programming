The details to this problem can be found at http://codeforces.com/contest/839/problem/C.
